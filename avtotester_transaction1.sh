#!/bin/bash

URL="http://localhost:8000/transactions"
AMOUNT="1000"

# Список отправителей (ID по убыванию)
SENDERS=(
"00000000-0000-0000-0000-000000000100"
"00000000-0000-0000-0000-000000000099"
"00000000-0000-0000-0000-000000000098"
"00000000-0000-0000-0000-000000000097"
"00000000-0000-0000-0000-000000000096"
"00000000-0000-0000-0000-000000000095"
"00000000-0000-0000-0000-000000000094"
"00000000-0000-0000-0000-000000000093"
"00000000-0000-0000-0000-000000000092"
"00000000-0000-0000-0000-000000000091"
"00000000-0000-0000-0000-000000000090"
"00000000-0000-0000-0000-000000000089"
"00000000-0000-0000-0000-000000000088"
"00000000-0000-0000-0000-000000000087"
"00000000-0000-0000-0000-000000000086"
"00000000-0000-0000-0000-000000000085"
"00000000-0000-0000-0000-000000000084"
"00000000-0000-0000-0000-000000000083"
"00000000-0000-0000-0000-000000000082"
"00000000-0000-0000-0000-000000000081"
"00000000-0000-0000-0000-000000000080"
"00000000-0000-0000-0000-000000000079"
"00000000-0000-0000-0000-000000000078"
"00000000-0000-0000-0000-000000000077"
"00000000-0000-0000-0000-000000000076"
"00000000-0000-0000-0000-000000000075"
"00000000-0000-0000-0000-000000000074"
"00000000-0000-0000-0000-000000000073"
"00000000-0000-0000-0000-000000000072"
"00000000-0000-0000-0000-000000000071"
"00000000-0000-0000-0000-000000000070"
"00000000-0000-0000-0000-000000000069"
"00000000-0000-0000-0000-000000000068"
"00000000-0000-0000-0000-000000000067"
"00000000-0000-0000-0000-000000000066"
"00000000-0000-0000-0000-000000000065"
"00000000-0000-0000-0000-000000000064"
"00000000-0000-0000-0000-000000000063"
"00000000-0000-0000-0000-000000000062"
"00000000-0000-0000-0000-000000000061"
"00000000-0000-0000-0000-000000000060"
"00000000-0000-0000-0000-000000000059"
"00000000-0000-0000-0000-000000000058"
"00000000-0000-0000-0000-000000000057"
"00000000-0000-0000-0000-000000000056"
"00000000-0000-0000-0000-000000000055"
"00000000-0000-0000-0000-000000000054"
"00000000-0000-0000-0000-000000000053"
"00000000-0000-0000-0000-000000000052"
"00000000-0000-0000-0000-000000000051"
"00000000-0000-0000-0000-000000000050"
"00000000-0000-0000-0000-000000000049"
"00000000-0000-0000-0000-000000000048"
"00000000-0000-0000-0000-000000000047"
"00000000-0000-0000-0000-000000000046"
"00000000-0000-0000-0000-000000000045"
"00000000-0000-0000-0000-000000000044"
"00000000-0000-0000-0000-000000000043"
"00000000-0000-0000-0000-000000000042"
"00000000-0000-0000-0000-000000000041"
"00000000-0000-0000-0000-000000000040"
"00000000-0000-0000-0000-000000000039"
"00000000-0000-0000-0000-000000000038"
"00000000-0000-0000-0000-000000000037"
"00000000-0000-0000-0000-000000000036"
"00000000-0000-0000-0000-000000000035"
"00000000-0000-0000-0000-000000000034"
"00000000-0000-0000-0000-000000000033"
"00000000-0000-0000-0000-000000000032"
"00000000-0000-0000-0000-000000000031"
"00000000-0000-0000-0000-000000000030"
"00000000-0000-0000-0000-000000000029"
"00000000-0000-0000-0000-000000000028"
"00000000-0000-0000-0000-000000000027"
"00000000-0000-0000-0000-000000000026"
"00000000-0000-0000-0000-000000000025"
"00000000-0000-0000-0000-000000000024"
"00000000-0000-0000-0000-000000000023"
"00000000-0000-0000-0000-000000000022"
"00000000-0000-0000-0000-000000000021"
"00000000-0000-0000-0000-000000000020"
"00000000-0000-0000-0000-000000000019"
"00000000-0000-0000-0000-000000000018"
"00000000-0000-0000-0000-000000000017"
"00000000-0000-0000-0000-000000000016"
"00000000-0000-0000-0000-000000000015"
"00000000-0000-0000-0000-000000000014"
"00000000-0000-0000-0000-000000000013"
"00000000-0000-0000-0000-000000000012"
"00000000-0000-0000-0000-000000000011"
"00000000-0000-0000-0000-000000000010"
"00000000-0000-0000-0000-000000000009"
"00000000-0000-0000-0000-000000000008"
"00000000-0000-0000-0000-000000000007"
"00000000-0000-0000-0000-000000000006"
"00000000-0000-0000-0000-000000000005"
"00000000-0000-0000-0000-000000000004"
"00000000-0000-0000-0000-000000000003"
"00000000-0000-0000-0000-000000000002"
"00000000-0000-0000-0000-000000000001"
"00000000-0000-0000-0000-000000000000"
)

# Список получателей (ID по возрастанию)
RECIPIENTS=(
"00000000-0000-0000-0000-000000000000"
"00000000-0000-0000-0000-000000000001"
"00000000-0000-0000-0000-000000000002"
"00000000-0000-0000-0000-000000000003"
"00000000-0000-0000-0000-000000000004"
"00000000-0000-0000-0000-000000000005"
"00000000-0000-0000-0000-000000000006"
"00000000-0000-0000-0000-000000000007"
"00000000-0000-0000-0000-000000000008"
"00000000-0000-0000-0000-000000000009"
"00000000-0000-0000-0000-000000000010"
"00000000-0000-0000-0000-000000000011"
"00000000-0000-0000-0000-000000000012"
"00000000-0000-0000-0000-000000000013"
"00000000-0000-0000-0000-000000000014"
"00000000-0000-0000-0000-000000000015"
"00000000-0000-0000-0000-000000000016"
"00000000-0000-0000-0000-000000000017"
"00000000-0000-0000-0000-000000000018"
"00000000-0000-0000-0000-000000000019"
"00000000-0000-0000-0000-000000000020"
"00000000-0000-0000-0000-000000000021"
"00000000-0000-0000-0000-000000000022"
"00000000-0000-0000-0000-000000000023"
"00000000-0000-0000-0000-000000000024"
"00000000-0000-0000-0000-000000000025"
"00000000-0000-0000-0000-000000000026"
"00000000-0000-0000-0000-000000000027"
"00000000-0000-0000-0000-000000000028"
"00000000-0000-0000-0000-000000000029"
"00000000-0000-0000-0000-000000000030"
"00000000-0000-0000-0000-000000000031"
"00000000-0000-0000-0000-000000000032"
"00000000-0000-0000-0000-000000000033"
"00000000-0000-0000-0000-000000000034"
"00000000-0000-0000-0000-000000000035"
"00000000-0000-0000-0000-000000000036"
"00000000-0000-0000-0000-000000000037"
"00000000-0000-0000-0000-000000000038"
"00000000-0000-0000-0000-000000000039"
"00000000-0000-0000-0000-000000000040"
"00000000-0000-0000-0000-000000000041"
"00000000-0000-0000-0000-000000000042"
"00000000-0000-0000-0000-000000000043"
"00000000-0000-0000-0000-000000000044"
"00000000-0000-0000-0000-000000000045"
"00000000-0000-0000-0000-000000000046"
"00000000-0000-0000-0000-000000000047"
"00000000-0000-0000-0000-000000000048"
"00000000-0000-0000-0000-000000000049"
"00000000-0000-0000-0000-000000000050"
"00000000-0000-0000-0000-000000000051"
"00000000-0000-0000-0000-000000000052"
"00000000-0000-0000-0000-000000000053"
"00000000-0000-0000-0000-000000000054"
"00000000-0000-0000-0000-000000000055"
"00000000-0000-0000-0000-000000000056"
"00000000-0000-0000-0000-000000000057"
"00000000-0000-0000-0000-000000000058"
"00000000-0000-0000-0000-000000000059"
"00000000-0000-0000-0000-000000000060"
"00000000-0000-0000-0000-000000000061"
"00000000-0000-0000-0000-000000000062"
"00000000-0000-0000-0000-000000000063"
"00000000-0000-0000-0000-000000000064"
"00000000-0000-0000-0000-000000000065"
"00000000-0000-0000-0000-000000000066"
"00000000-0000-0000-0000-000000000067"
"00000000-0000-0000-0000-000000000068"
"00000000-0000-0000-0000-000000000069"
"00000000-0000-0000-0000-000000000070"
"00000000-0000-0000-0000-000000000071"
"00000000-0000-0000-0000-000000000072"
"00000000-0000-0000-0000-000000000073"
"00000000-0000-0000-0000-000000000074"
"00000000-0000-0000-0000-000000000075"
"00000000-0000-0000-0000-000000000076"
"00000000-0000-0000-0000-000000000077"
"00000000-0000-0000-0000-000000000078"
"00000000-0000-0000-0000-000000000079"
"00000000-0000-0000-0000-000000000080"
"00000000-0000-0000-0000-000000000081"
"00000000-0000-0000-0000-000000000082"
"00000000-0000-0000-0000-000000000083"
"00000000-0000-0000-0000-000000000084"
"00000000-0000-0000-0000-000000000085"
"00000000-0000-0000-0000-000000000086"
"00000000-0000-0000-0000-000000000087"
"00000000-0000-0000-0000-000000000088"
"00000000-0000-0000-0000-000000000089"
"00000000-0000-0000-0000-000000000090"
"00000000-0000-0000-0000-000000000091"
"00000000-0000-0000-0000-000000000092"
"00000000-0000-0000-0000-000000000093"
"00000000-0000-0000-0000-000000000094"
"00000000-0000-0000-0000-000000000095"
"00000000-0000-0000-0000-000000000096"
"00000000-0000-0000-0000-000000000097"
"00000000-0000-0000-0000-000000000098"
"00000000-0000-0000-0000-000000000099"
"00000000-0000-0000-0000-000000000100"
)

# Количество транзакций на каждого отправителя
TX_PER_SENDER=1

# Запускаем тест
for ((i = 0; i < ${#SENDERS[@]}; i++)); do
  SENDER="${SENDERS[$i]}"
  RECIPIENT="${RECIPIENTS[$i]}"

  for ((j = 1; j <= TX_PER_SENDER; j++)); do
    echo "Транзакция #$j: Отправитель $SENDER -> Получатель $RECIPIENT"
    
    curl -X 'POST' "$URL" \
      -H 'Content-Type: application/json' \
      -d "{
        \"amount\": \"$AMOUNT\",
        \"sender\": \"$SENDER\",
        \"recipient\": \"$RECIPIENT\"
      }" \
      --silent --output /dev/null &  # Фоновый процесс для ускорения

    sleep 0.01  # Небольшая пауза для уменьшения нагрузки на БД
  done
done

echo "✅ Тестирование завершено!"